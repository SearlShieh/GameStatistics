<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>æ•°æ®ç»Ÿè®¡</title>
  <!-- Vue2 -->
  <script src="./static/vue.js"></script>
  <!-- Element UI -->
  <link rel="stylesheet" href="./static/element.css">
  <script src="./static/element.js"></script>
  <script src="./gameConfig.js"></script>
  <script src="./gameMethods.js"></script>
  <!-- æ¸¸æˆé£æ ¼å­—ä½“ -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&display=swap" rel="stylesheet">
  <link href="./index.css" rel="stylesheet">
</head>
<body>
  <div id="app" class="game-container">
    <!-- å¼¹çª—é®ç½©å±‚ï¼ˆæ–°å¢ï¼‰ -->
    <div class="modal-mask" v-if="showRule" @click="showRule = false"></div>
    
    <!-- æ¸¸æˆè§„åˆ™å¼¹çª— -->
    <div class="rule-modal" v-if="showRule">
      <h3 class="rule-title">ğŸ® æ¸¸æˆæ•°æ®ç»Ÿè®¡è§„åˆ™</h3>
      <div class="rule-content" style="height: 70vh;overflow: auto;">
        <div v-for="ruleItem in rewordData" :key="ruleItem.name">
          <div style="text-align: center;">ã€{{ruleItem.name}}ã€‘</div>
          <div  style="text-align: center;position: relative;top: -4px">
            <span style="color: rgba(10, 250, 202, 0.5);">{{ruleItem.tip}}</span>
            <span style="margin-left: 4px">å¥–åŠ± <span style="color: rgba(10, 250, 202, 0.5);font-size: 20px">{{ruleItem.count || ruleItem.value}}</span> æŠŠ</span>
          </div>
        </div>
      </div>
      <!-- ä¼˜åŒ–å…³é—­æŒ‰é’® -->
      <el-button 
        type="success" 
        @click="showRule = false" 
        class="close-btn"
        :loading="false"
      >
        å¼€å§‹ç»Ÿè®¡
      </el-button>
    </div>
    
    <!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
    <div class="progress-indicator" v-if="!showRule">
      <div class="progress-dot" v-for="item in defaultSize" :class="{active: gameIndex === item-1}"></div>
    </div>
    
    <!-- æ¸¸æˆæ•°æ®å½•å…¥å¡ç‰‡ -->
    <div class="game-card" v-if="!showRule">
      <div class="game-card-header">
        <h3 class="game-card-title">ç¬¬ {{ gameIndex + 1 }} å±€æ¸¸æˆæ•°æ®</h3>
        <el-button type="text" @click="showRule = true" style="color: #00ccff;">æŸ¥çœ‹è§„åˆ™</el-button>
      </div>

      <div class="item-list-box">      
      <div class="item-list">
        <div class="item-list-title">å›æ”¶ç‰©æ•°æ®</div>
        <div class="item-row" v-for="item in goodsData" :key="item.value">
          <label class="item-label">{{item.name}}ï¼š</label>
          <el-input-number
            v-model="allGameData[gameIndex][item.value]" 
            :min="0"
            :max="6"
            class="item-input"
            style="width: calc(100vw - 100px)"
            placeholder="è¾“å…¥æ•°é‡"
          ></el-input-number>
          <span>ä¸ª</span>
        </div>
        <div class="item-list-title">å…¶ä»–æ•°æ®</div>
        <div class="item-row">
          <label class="item-label">æ˜¯å¦æœ‰å®è—æˆ¿ï¼š</label>
          <el-checkbox v-model="allGameData[gameIndex].hasBz"></el-checkbox>
        </div>
        <div class="item-row">
          <label class="item-label">å¸¦å‡ºé‡‘é¢ï¼š</label>
          <el-input-number
            v-model="allGameData[gameIndex].money" 
            :min="0"
            :max="500"
            class="item-input"
            placeholder="è¾“å…¥é‡‘é¢"
          ></el-input-number>
          <span>ä¸‡</span>
        </div>
      </div>
      </div>
      
      <div class="btn-group">
        <el-button 
          type="primary" 
          @click="prevGame" 
          :disabled="gameIndex === 0"
        >
          ä¸Šä¸€å±€
        </el-button>
        <!-- <el-button 
          type="success" 
          @click="saveCurrentGame"
        >
          ä¿å­˜å½“å‰å±€
        </el-button> -->
        <el-button 
          type="primary" 
          @click="nextGame" 
          :disabled="gameIndex === defaultSize-1"
        >
          ä¸‹ä¸€å±€
        </el-button>
      </div>
    </div>

    <div style="text-align: center;">
      <el-button 
      @click="resetData"
          type="primary" 
        >
          é‡ç½®
        </el-button>
        <el-button 
          type="primary" 
          @click="viewData" 
        >
          æŸ¥çœ‹å½“å‰ç»Ÿè®¡æ•°æ®
        </el-button>
        <el-button 
          type="primary" 
          @click="getReword"
        >
          ç»“ç®—å¥–åŠ±
        </el-button>
    </div>
    
    <!-- æ¸¸æˆè§„åˆ™å¼¹çª— -->
    <div class="rule-modal" v-if="showData">
      <h3 class="rule-title">ğŸ® æ¸¸æˆæ•°æ®ç»Ÿè®¡</h3>
      <div class="rule-content" style="height: 70vh;overflow: auto;">
        <div v-for="ruleItem in rewordData" :key="ruleItem.name">
          <div style="text-align: center;">ã€{{ruleItem.name}}ã€‘</div>
          <div  style="text-align: center;position: relative;top: -4px">
            <span style="color: rgba(10, 250, 202, 0.5);">{{ruleItem.tip}}</span>
            <span style="margin-left: 4px">å¥–åŠ± <span style="color: rgba(10, 250, 202, 0.5);font-size: 20px">{{ruleItem.count || ruleItem.value}}</span> æŠŠ</span>
          </div>
          <div class="rule-data" style="text-align: center;color: rgba(0, 193, 154, 0.5)" v-if="ruleItem.show" v-html="ruleItem.show(gameData)"></div>
        </div>
      </div>
      <!-- ä¼˜åŒ–å…³é—­æŒ‰é’® -->
      <el-button 
        type="success" 
        @click="showData = false" 
        class="close-btn"
      >
        çŸ¥é“äº†
      </el-button>
    </div>
    
    <!-- å½©è›‹åŠ¨ç”»å®¹å™¨ -->
    <div class="egg-container" ref="eggContainer"></div>
    <div class="close-btn2" v-if="showReword" @click="close">
      <i class="el-icon-close"></i>
    </div>
  </div>

  <script>
    // 3. åˆå§‹åŒ– Vue å®ä¾‹ï¼Œç›´æ¥å¼•å…¥å¤–éƒ¨æ–¹æ³•/è®¡ç®—å±æ€§
    document.addEventListener('DOMContentLoaded', function() {
      new Vue({
        el: '#app',
        data() {
          return {
          showRule: true, // æ˜¯å¦æ˜¾ç¤ºæ¸¸æˆè§„åˆ™
          gameIndex: 0, // å½“å‰æ¸¸æˆå±€æ•°ç´¢å¼•ï¼ˆ0-5ï¼‰
          totalEggs: 0, // æ€»è§¦å‘å½©è›‹æ•°
          // å½©è›‹è§„åˆ™é…ç½®
          eggRules: [
            {
              name: "é»„é‡‘ä¹‹æ‰‹",
              condition: (game) => game.goldenKey >= 5,
              description: "å•å±€å¸¦å‡º5æŠŠä»¥ä¸Šé»„é‡‘é’¥åŒ™ï¼"
            },
            {
              name: "é’»çŸ³å¤§äº¨",
              condition: (game) => game.diamond >= 10,
              description: "å•å±€å¸¦å‡º10é¢—ä»¥ä¸Šé’»çŸ³ï¼"
            },
            {
              name: "è£…å¤‡å¤§å¸ˆ",
              condition: (game) => game.rareEquipment >= 3,
              description: "å•å±€å¸¦å‡º3ä»¶ä»¥ä¸Šç¨€æœ‰è£…å¤‡ï¼"
            },
            {
              name: "è´¢å¯Œå¯†ç ",
              condition: (game) => game.money >= 10000,
              description: "å•å±€å¸¦å‡º10000é‡‘å¸ä»¥ä¸Šï¼"
            },
            {
              name: "èƒ½é‡æŒæ§è€…",
              condition: (game) => game.energyCore >= 8,
              description: "å•å±€å¸¦å‡º8ä¸ªä»¥ä¸Šèƒ½é‡æ ¸å¿ƒï¼"
            },
            {
              name: "å…¨èƒ½æˆ˜ç¥",
              condition: (game) => game.goldenKey >= 3 && game.diamond >= 5 && game.rareEquipment >= 2,
              description: "å•å±€é›†é½å¤šç§ç¨€æœ‰ç‰©å“ï¼"
            }
          ],
          allGameData: [],
          // æœ€å¤šå…«å±€ 
          defaultSize: 8,
          goodsData: window.GAME_CONFIG.goodsData,
          rewordData: window.GAME_CONFIG.rewordData,
          showData: false,
          gameData: {},
          showReword: false,
          toastElement: false
          };
        },
        computed: {
          ...window.Game.computed
        },
        methods: {
          ...window.Game.methods
        },
        created() {
          for(let i=0;i<8;i++){
            const params= {
              hasBz: false,
              money: 0
            }
            this.goodsData.forEach(item=>{
              params[item.value] = 0
            })
            this.allGameData.push({...params})
          }
        },
      });
    });
  </script>

</body>
</html>
